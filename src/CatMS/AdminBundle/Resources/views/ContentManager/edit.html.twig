{% extends 'CatMSAdminBundle::base.html.twig' %}

{% block stylesheets %}
    input { width: 500px; }
{% endblock %}

{% block javascripts_bottom %}
    <script type="text/javascript" src="{{ asset('js/tinymce/tinymce.min.js')}}"></script>
    <script type="text/javascript" src="{{ asset('js/text-editor.js')}}"></script>
    {% if not is_granted('ROLE_DEVELOPER') %}
    <script>
        $('.checkDeveloper').attr('readonly', 'readonly');
    </script>
    {% endif %}
{% endblock %}
   
{% block breadcrumb %}
    {{ parent() }}
    {% if group is empty %}
    <li><a href="{{ path('content-manager') }}">Content manager</a></li> <span class="divider">/</span>
    <li><a href="{{ path('content-manager-list') }}">Content list</a></li> <span class="divider">/</span>
    <li class="active">Edit {{ truncate(entity.description | striptags, 40) | raw }} </li>
    {% else %}
    <li><a href="{{ path('content-group') }}">Content groups</a></li> <span class="divider">/</span>
    <li><a href="{{ path('content-manager-list', {'page': 1, 'slug': group}) }}">Group {{ entity.contentGroup.description | raw }} contents</a></li> <span class="divider">/</span>
    <li class="active">{{ entity.description | raw }}</li>
    {% endif %}
{% endblock %}
    
{% block content %}
    <legend>{{ entity.description | striptags | raw }} edit</legend>
    
    {# Related Images #}
    {% if group is not empty %}
        {% include 'CatMSAdminBundle:Helpers:related-images.html.twig' with {'group': entity.contentGroup } %}
    {% endif %}
    {# End Related Images#}
    
    {% if entity.contentGroup.manual %}
    <div class="alert alert-success">
    <button type="button" class="close" data-dismiss="alert">&times;</button>
    <h4>Tutorial available!</h4>
    This page has defined  manual. <a class="btn btn-primary  btn-mini" href="#tutorial">Read tutorial</a>
    </div>
    {% endif %}
    
    <form novalidate action="{{ path('content-manager-update', { 'id': entity.id, 'group': group }) }}" method="post" {{ form_enctype(edit_form) }} style="width: 100%" class="content-manager-form">
        
        <label for="catms_adminbundle_contentmanagertype_slug" class="before-hide well"><i class="icon-bookmark"></i> Slug</label>
        {{ form_widget(edit_form.slug, {'attr': {'class': 'checkDeveloper' }}) }}    
        {{ form_errors(edit_form.slug) }}    
        <hr />
        
        <label for="#" class="before-tiny well"><i class="icon-chevron-down"></i> Description</label>
        {{ form_widget(edit_form.description) }}    
        {{ form_errors(edit_form.description) }}       
        <hr />
        
        <label for="#" class="before-tiny well"><i class="icon-chevron-down"></i> Title</label>
        {{ form_widget(edit_form.title) }}    
        {{ form_errors(edit_form.title) }}    
        <hr />
        
        <label for="#" class="before-tiny well"><i class="icon-chevron-down"></i> Short text</label>
        {{ form_widget(edit_form.shortText) }}    
        {{ form_errors(edit_form.shortText) }}    
        <hr />
        
        <label for="#" class="before-tiny well"><i class="icon-chevron-down"></i> Full text</label>
        {{ form_widget(edit_form.fullText) }}    
        {{ form_errors(edit_form.fullText) }}  
        <hr />
        
        <label for="#" class=""><i class="icon-chevron-down"></i> Content group</label>
        {{ form_widget(edit_form.contentGroup) }}    
        {{ form_errors(edit_form.contentGroup) }}  
        <hr />
        
        <label for="#" class=""><i class="icon-chevron-down"></i> Priority</label>
        {{ form_widget(edit_form.priority) }}    
        {{ form_errors(edit_form.priority) }}  
        <hr />
        
        {{ form_rest(edit_form) }}
        
        <input type="hidden" name="_method" value="PUT" />

        <div class="btn-group">
            {% if group is empty %}
            <a href="{{ path('content-manager-list') }}" class="btn"><i class="icon-list"></i> Back to the list</a>
            {% else %}
            <a href="{{ path('content-manager-list', {'page': 1, 'slug': group}) }}" class="btn"><i class="icon-list"></i> Back to the list</a>
            {% endif %}
            <button type="submit" class="btn btn-primary show-loader" data-loading-text="Loading..."><i class="icon-hdd"></i> Save</button>
        </div>
        
    </form>
    
    <form action="{{ path('content-manager-delete', { 'id': entity.id, 'group': group }) }}" method="post">
        <input type="hidden" name="_method" value="DELETE" />
        {{ form_widget(delete_form) }}
        <button type="submit" class="btn" data-toggle="modal" data-target="#delete"><i class="icon-trash"></i> Delete</button>
        {% include 'CatMSAdminBundle:Helpers:modal.html.twig' with {'id': 'delete', 'msg': 'Delete content', 'btnTxt': 'Delete'} %}
    </form>
    
    {% if entity.contentGroup.manual %}
    <div id="tutorial">
        {{ entity.contentGroup.manual | raw }}
    </div>
    {% endif %}
    
{% endblock %}
